# ç«¥è£…ç”µå•†AIå·¥ä½œæµä¼˜åŒ–è®¡åˆ’

> åŸºäºSHEINçˆ†æ¬¾åˆ†æ + Nanobanana Proæ¨¡å‹ä¼˜åŒ–æ–¹æ¡ˆ
> åˆ›å»ºæ—¥æœŸ: 2025-12-12

---

## ä¸€ã€SHEINçˆ†æ¬¾å›¾ç‰‡é£æ ¼åˆ†æ

### 1.1 äº§å“å±•ç¤ºé£æ ¼åˆ†ç±»

æ ¹æ®æä¾›çš„SHEINç«¥è£…å›¾ç‰‡ï¼Œè¯†åˆ«å‡ºä»¥ä¸‹ä¸»è¦å±•ç¤ºé£æ ¼ï¼š

| é£æ ¼ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|---------|------|---------|------|
| **Flat Lay å¹³é“º** | è¡£æœå¹³é“º+é“å…·è£…é¥°ï¼Œä¿¯æ‹è§†è§’ | å¥—è£…å±•ç¤ºã€ç¡è¡£ã€å®¶å±…æœ | å½©è™¹ç¡è¡£å¥—è£…ã€çˆ±å¿ƒå°èŠ±å¥—è£… |
| **æŒ‚æ‹ Hanger** | è¡£æ¶æ‚¬æŒ‚ï¼Œç®€æ´èƒŒæ™¯ | å•å“å±•ç¤ºã€å«è¡£ã€å¤–å¥— | æ ¡å›­é£å¼€è¡«ã€å­—æ¯å«è¡£ |
| **åœºæ™¯æ­é…** | ä¸»é¢˜èƒŒæ™¯+é…é¥°é“å…· | IPè”åã€èŠ‚æ—¥æ¬¾ | ä¸‡åœ£èŠ‚èœ˜è››ä¾ ã€åŠ è²çŒ«å¥—è£… |
| **æ¨¡ç‰¹å®æ‹** | çœŸäººæ¨¡ç‰¹ç©¿ç€å±•ç¤º | é«˜ç«¯æ¬¾ã€äº²å­è£… | åœ£è¯äº²å­ç¡è¡£ |

### 1.2 çˆ†æ¬¾å›¾æ¡ˆå°èŠ±ç±»å‹

ä»å›¾ç‰‡ä¸­è¯†åˆ«çš„çƒ­é—¨å›¾æ¡ˆç±»å‹ï¼š

#### A. IPè§’è‰²è”å (é«˜é”€é‡)
- **ç»å…¸å¡é€š**: åŠ è²çŒ«(Garfield)ã€å¤§åŠ›æ°´æ‰‹(Popeye)ã€çŒ«å’Œè€é¼ (Tom & Jerry)
- **åŠ¨ç”»IP**: æ±ªæ±ªé˜Ÿ(PAW Patrol)ã€CoComelonã€Nick 90så¤å¤
- **æ½®æµIP**: TRALALAé²¨é±¼ã€Sparklynç²‰çŒ«

#### B. å›¾æ¡ˆå…ƒç´  (ä¸­é«˜é”€é‡)
- **å‡ ä½•å›¾å½¢**: çˆ±å¿ƒâ¤ï¸ã€æ˜Ÿæ˜Ÿâ­ã€è´è¶ç»“ğŸ€ã€å½©è™¹ğŸŒˆ
- **å­—æ¯æ–‡å­—**: "LOVE"ã€"B"å­—æ¯è´´å¸ƒã€"NEW YORK"
- **åŠ¨ç‰©å›¾æ¡ˆ**: æé¾™ã€å…”å­ã€å°ç†Šã€è´è¶

#### C. é£æ ¼ä¸»é¢˜ (ç¨³å®šé”€é‡)
- **å­¦é™¢é£**: å­—æ¯è´´å¸ƒã€æ¡çº¹ã€æ ¼çº¹
- **ç”œç¾é£**: è´è¶ç»“ã€çˆ±å¿ƒã€ç²‰è‰²ç³»
- **è¿åŠ¨é£**: æ•°å­—ã€çƒé˜Ÿé£æ ¼ã€æ’è‰²æ‹¼æ¥

### 1.3 è‰²å½©è¶‹åŠ¿åˆ†æ

| è‰²ç³» | çƒ­é—¨ç»„åˆ | é€‚ç”¨é£æ ¼ |
|-----|---------|---------|
| **ç²‰è‰²ç³»** | ç²‰+ç™½ã€ç²‰+ç°ã€ç²‰+ç´« | å¥³ç«¥ç”œç¾ã€å…¬ä¸»é£ |
| **è“è‰²ç³»** | è“+ç™½ã€è“+é»„ã€è“+çº¢ | ç”·ç«¥è¿åŠ¨ã€æµ·æ´‹é£ |
| **ä¸­æ€§è‰²** | ç°+ç™½ã€ç±³+æ£•ã€é»‘+ç™½ | å­¦é™¢é£ã€ç®€çº¦é£ |
| **æ’è‰²ç³»** | çº¢+è“+é»„ã€æ©™+è“ | IPè”åã€è¿åŠ¨é£ |

### 1.4 æ‘„å½±é£æ ¼ç‰¹ç‚¹

#### Flat Lay å¹³é“ºé£æ ¼è¦ç‚¹ï¼š
```
- èƒŒæ™¯: æµ…è‰²æœ¨çº¹/ç™½è‰²æ¯›ç»’æ¯¯/ç±³è‰²é’ˆç»‡å¸ƒ
- é“å…·: ä¸æœè£…ä¸»é¢˜ç›¸å…³çš„å°ç‰©ä»¶
  - çˆ±å¿ƒæœè£… â†’ çˆ±å¿ƒè£…é¥°ã€ç²‰è‰²èŠ±æœµ
  - æé¾™æœè£… â†’ æé¾™ç©å…·ã€æ˜Ÿæ˜Ÿè£…é¥°
  - ç¡è¡£å¥—è£… â†’ æ¯›ç»’ç©å…·ã€æ•å¤´
- æ„å›¾: 45åº¦æ–œæ”¾æˆ–æ­£æ”¾ï¼Œç•™ç™½é€‚ä¸­
- å…‰çº¿: æŸ”å’Œè‡ªç„¶å…‰ï¼Œæ— å¼ºçƒˆé˜´å½±
```

#### æŒ‚æ‹é£æ ¼è¦ç‚¹ï¼š
```
- èƒŒæ™¯: çº¯è‰²å¢™é¢/æœ¨æ¿å¢™/ç®€çº¦åœºæ™¯
- è¡£æ¶: æœ¨è´¨è¡£æ¶æˆ–å„¿ç«¥ä¸“ç”¨è¡£æ¶
- é…é¥°: å¸½å­ã€åŒ…åŒ…ã€é‹å­æ­é…
- æ„å›¾: å±…ä¸­æˆ–ä¸‰åˆ†æ³•ï¼Œçªå‡ºæœè£…
```

---

## äºŒã€èŠ‚ç‚¹ä¼˜åŒ–ä»»åŠ¡æ¸…å•

### 2.1 å›¾æ¡ˆç”ŸæˆèŠ‚ç‚¹ (GeminiPatternNode)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|-----|-------|------|------|
| æ·»åŠ SHEINçˆ†æ¬¾é£æ ¼é¢„è®¾ | P0 | â¬œ å¾…å¼€å§‹ | åŸºäºåˆ†ææ·»åŠ 10+æ–°é¢„è®¾ |
| ä¼˜åŒ–æ— ç¼å¹³é“ºæç¤ºè¯ | P0 | â¬œ å¾…å¼€å§‹ | å¼ºåŒ–seamlessè¦æ±‚ |
| æ·»åŠ IPé£æ ¼ç”Ÿæˆæ¨¡å¼ | P1 | â¬œ å¾…å¼€å§‹ | æ”¯æŒç±»IPè§’è‰²ç”Ÿæˆ |
| ä¼˜åŒ–è‰²å½©æ§åˆ¶æç¤ºè¯ | P1 | â¬œ å¾…å¼€å§‹ | æ›´ç²¾å‡†çš„è‰²å½©æŒ‡å¯¼ |

### 2.2 ç”µå•†å®æ‹å›¾èŠ‚ç‚¹ (GeminiEcomNode)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|-----|-------|------|------|
| æ·»åŠ Flat Layå¹³é“ºæ¨¡å¼ | P0 | â¬œ å¾…å¼€å§‹ | SHEINä¸»æµå±•ç¤ºæ–¹å¼ |
| æ·»åŠ æŒ‚æ‹æ¨¡å¼ | P0 | â¬œ å¾…å¼€å§‹ | å•å“å±•ç¤ºæ–¹å¼ |
| ä¼˜åŒ–é“å…·æ­é…æç¤ºè¯ | P1 | â¬œ å¾…å¼€å§‹ | æ™ºèƒ½é“å…·æ¨è |
| æ·»åŠ èƒŒæ™¯é£æ ¼é¢„è®¾ | P1 | â¬œ å¾…å¼€å§‹ | æœ¨çº¹/æ¯›ç»’/çº¯è‰²ç­‰ |

### 2.3 æ¨¡ç‰¹ç”ŸæˆèŠ‚ç‚¹ (GeminiModelNode)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|-----|-------|------|------|
| ä¼˜åŒ–ç«¥æ¨¡å¹´é¾„æ®µæè¿° | P0 | â¬œ å¾…å¼€å§‹ | 4-7å²ç²¾å‡†æè¿° |
| æ·»åŠ SHEINé£æ ¼é¢„è®¾ | P0 | â¬œ å¾…å¼€å§‹ | å¹´è½»æ´»åŠ›é£æ ¼ |
| ä¼˜åŒ–å§¿æ€è‡ªç„¶åº¦ | P1 | â¬œ å¾…å¼€å§‹ | æ›´è‡ªç„¶çš„ç«¥æ¨¡å§¿æ€ |
| æ·»åŠ åœºæ™¯èƒŒæ™¯é¢„è®¾ | P1 | â¬œ å¾…å¼€å§‹ | ä¸æœè£…ä¸»é¢˜åŒ¹é… |

---

## ä¸‰ã€Nanobanana Pro å®Œç¾æµæ°´çº¿æ–¹æ¡ˆ

### 3.1 æµæ°´çº¿æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®Œç¾ç«¥è£…ç”µå•†æµæ°´çº¿                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [è¾“å…¥] â”€â”€â–º [å›¾æ¡ˆç”Ÿæˆ] â”€â”€â–º [Mockupè´´å›¾] â”€â”€â–º [ç”µå•†å±•ç¤ºå›¾] â”€â”€â–º [è¾“å‡º] â”‚
â”‚                                                                 â”‚
â”‚  Stage 1: å›¾æ¡ˆè®¾è®¡                                               â”‚
â”‚  â”œâ”€â”€ é£æ ¼é€‰æ‹© (IPé£æ ¼/å‡ ä½•å›¾æ¡ˆ/å­—æ¯æ–‡å­—)                           â”‚
â”‚  â”œâ”€â”€ è‰²å½©æ–¹æ¡ˆ (ç²‰è‰²ç³»/è“è‰²ç³»/æ’è‰²ç³»)                               â”‚
â”‚  â””â”€â”€ å›¾æ¡ˆç”Ÿæˆ (Nanobanana Pro)                                   â”‚
â”‚                                                                 â”‚
â”‚  Stage 2: æœè£…è´´å›¾                                               â”‚
â”‚  â”œâ”€â”€ åº•è¡£é€‰æ‹© (Tæ¤/å«è¡£/å¥—è£…)                                     â”‚
â”‚  â”œâ”€â”€ è´´å›¾ä½ç½® (èƒ¸å‰/å…¨èº«/è£¤å­)                                    â”‚
â”‚  â””â”€â”€ Mockupç”Ÿæˆ (Gemini Edit)                                   â”‚
â”‚                                                                 â”‚
â”‚  Stage 3: ç”µå•†å±•ç¤º                                               â”‚
â”‚  â”œâ”€â”€ å±•ç¤ºæ¨¡å¼ (Flat Lay/æŒ‚æ‹/æ¨¡ç‰¹)                               â”‚
â”‚  â”œâ”€â”€ èƒŒæ™¯é£æ ¼ (æœ¨çº¹/æ¯›ç»’/åœºæ™¯)                                    â”‚
â”‚  â””â”€â”€ æœ€ç»ˆæ¸²æŸ“ (Gemini Generate)                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å„é˜¶æ®µè¯¦ç»†é…ç½®

#### Stage 1: å›¾æ¡ˆç”Ÿæˆ (Nanobanana Pro)

**æ¨èå‚æ•°é…ç½®:**
```json
{
  "model": "nanobanana-pro",
  "style_preset": "shein_kids_cute",
  "output_format": "seamless_tile",
  "resolution": "1024x1024",
  "color_mode": "vibrant_pastel"
}
```

**æ–°å¢é£æ ¼é¢„è®¾:**
- `shein_kawaii` - æ—¥ç³»å¯çˆ±é£
- `shein_sporty` - è¿åŠ¨æ´»åŠ›é£
- `shein_preppy` - å­¦é™¢é£
- `shein_ip_style` - IPè§’è‰²é£
- `shein_geometric` - å‡ ä½•å›¾æ¡ˆé£

#### Stage 2: Mockupè´´å›¾ (Gemini Edit)

**è´´å›¾æ¨¡å¼:**
- `placement_print` - èƒ¸å‰å°èŠ± (Tæ¤ã€å«è¡£)
- `allover_print` - å…¨èº«å°èŠ± (ç¡è¡£ã€è£¤å­)
- `set_mockup` - å¥—è£…è´´å›¾ (ä¸Šè¡£+è£¤å­)

#### Stage 3: ç”µå•†å±•ç¤º (Gemini Generate)

**å±•ç¤ºæ¨¡å¼é¢„è®¾:**
```typescript
const DISPLAY_MODES = {
  flat_lay: {
    name: 'Flat Lay å¹³é“º',
    background: ['wood_texture', 'white_fur', 'knit_fabric'],
    props: ['themed_toys', 'accessories', 'flowers'],
    angle: 'top_down_45deg'
  },
  hanger: {
    name: 'æŒ‚æ‹å±•ç¤º',
    background: ['white_wall', 'wood_panel', 'gradient'],
    props: ['hat', 'bag', 'shoes'],
    angle: 'front_straight'
  },
  model: {
    name: 'æ¨¡ç‰¹å®æ‹',
    background: ['studio', 'lifestyle', 'outdoor'],
    pose: ['natural', 'playful', 'confident'],
    angle: 'eye_level'
  }
}
```

---

## å››ã€æ–°å¢é¢„è®¾æ¨¡å—è®¾è®¡

### 4.1 SHEINçˆ†æ¬¾é£æ ¼é¢„è®¾

```typescript
// constants/sheinPresets.ts

export const SHEIN_PATTERN_PRESETS = [
  // IPè§’è‰²é£æ ¼
  {
    id: 'ip_kawaii_animal',
    name: 'KawaiiåŠ¨ç‰©IP',
    prompt: 'Cute kawaii animal character, big eyes, soft pastel colors, chibi style, friendly expression, suitable for kids clothing print',
    tags: ['IP', 'å¯çˆ±', 'åŠ¨ç‰©']
  },
  {
    id: 'ip_cartoon_hero',
    name: 'å¡é€šè‹±é›„IP',
    prompt: 'Cartoon hero character, bold colors, dynamic pose, comic style, energetic and fun, suitable for boys clothing',
    tags: ['IP', 'ç”·ç«¥', 'è‹±é›„']
  },

  // å‡ ä½•å›¾æ¡ˆ
  {
    id: 'geo_hearts_scatter',
    name: 'çˆ±å¿ƒæ•£ç‚¹',
    prompt: 'Scattered heart pattern, various sizes, pink and red tones, playful arrangement, seamless tile for fabric',
    tags: ['å‡ ä½•', 'çˆ±å¿ƒ', 'å¥³ç«¥']
  },
  {
    id: 'geo_rainbow_stripe',
    name: 'å½©è™¹æ¡çº¹',
    prompt: 'Rainbow stripe pattern, soft pastel colors, horizontal or diagonal stripes, cheerful and bright',
    tags: ['å‡ ä½•', 'å½©è™¹', 'ä¸­æ€§']
  },

  // å­—æ¯æ–‡å­—
  {
    id: 'text_varsity_letter',
    name: 'å­¦é™¢å­—æ¯',
    prompt: 'Varsity style letter patch, chenille texture, classic college font, navy and white colors',
    tags: ['æ–‡å­—', 'å­¦é™¢é£', 'ä¸­æ€§']
  },
  {
    id: 'text_love_script',
    name: 'LOVEæ‰‹å†™ä½“',
    prompt: 'Handwritten "LOVE" script, romantic cursive font, pink or red color, with small hearts',
    tags: ['æ–‡å­—', 'ç”œç¾', 'å¥³ç«¥']
  }
]

export const SHEIN_DISPLAY_PRESETS = [
  {
    id: 'flat_lay_cozy',
    name: 'æ¸©é¦¨å¹³é“º',
    background: 'soft white fur blanket or knit texture',
    props: 'matching accessories, small plush toys, dried flowers',
    lighting: 'soft natural daylight, no harsh shadows',
    composition: '45-degree angle, centered garment, props around edges'
  },
  {
    id: 'flat_lay_wood',
    name: 'æœ¨çº¹å¹³é“º',
    background: 'light wood grain texture, rustic feel',
    props: 'themed decorations matching the print, simple accessories',
    lighting: 'warm natural light, slight shadows for depth',
    composition: 'straight top-down or slight angle, clean arrangement'
  },
  {
    id: 'hanger_minimal',
    name: 'ç®€çº¦æŒ‚æ‹',
    background: 'clean white or light gray wall',
    props: 'wooden hanger, optional hat or bag',
    lighting: 'even studio lighting, soft shadows',
    composition: 'centered, full garment visible, minimal distractions'
  }
]
```

### 4.2 å¹´é¾„æ®µä¼˜åŒ–é¢„è®¾

```typescript
export const SHEIN_AGE_PRESETS = {
  young_girls_4_7: {
    label: 'Young Girls (4-7å²)',
    appearance: 'cute young girl, 4-7 years old, innocent expression, natural hair',
    pose: 'playful, natural, slightly shy or curious',
    style_keywords: ['cute', 'sweet', 'playful', 'innocent']
  },
  young_boys_4_7: {
    label: 'Young Boys (4-7å²)',
    appearance: 'energetic young boy, 4-7 years old, bright smile, neat hair',
    pose: 'active, confident, adventurous',
    style_keywords: ['cool', 'sporty', 'fun', 'adventurous']
  },
  toddler_1_3: {
    label: 'Toddler (1-3å²)',
    appearance: 'adorable toddler, 1-3 years old, chubby cheeks, soft features',
    pose: 'sitting, standing with support, natural baby movements',
    style_keywords: ['adorable', 'soft', 'gentle', 'precious']
  }
}
```

---

## äº”ã€å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€ä¼˜åŒ– (æœ¬å‘¨)

- [ ] åˆ›å»º `constants/sheinPresets.ts` é¢„è®¾æ–‡ä»¶
- [ ] æ›´æ–° `GeminiPatternNode` æ·»åŠ æ–°é£æ ¼é¢„è®¾
- [ ] æ›´æ–° `GeminiEcomNode` æ·»åŠ Flat Layæ¨¡å¼
- [ ] ä¼˜åŒ–ç³»ç»Ÿæç¤ºè¯ï¼Œèå…¥SHEINé£æ ¼è¦æ±‚

### Phase 2: æµæ°´çº¿ä¼˜åŒ– (ä¸‹å‘¨)

- [ ] è®¾è®¡å®Œæ•´çš„Nanobanana Proå·¥ä½œæµæ¨¡æ¿
- [ ] æ·»åŠ æ™ºèƒ½é“å…·æ¨èåŠŸèƒ½
- [ ] ä¼˜åŒ–Mockupè´´å›¾è´¨é‡
- [ ] æ·»åŠ æ‰¹é‡ç”Ÿæˆæ”¯æŒ

### Phase 3: é¢„è®¾æ¨¡å—å‡çº§ (åç»­)

- [ ] æ·»åŠ æ›´å¤šIPé£æ ¼é¢„è®¾
- [ ] æ·»åŠ å­£èŠ‚æ€§é¢„è®¾ (åœ£è¯ã€ä¸‡åœ£èŠ‚ç­‰)
- [ ] æ·»åŠ å¹³å°ç‰¹å®šé¢„è®¾ (SHEIN/TEMU/Amazon)
- [ ] ç”¨æˆ·è‡ªå®šä¹‰é¢„è®¾åŠŸèƒ½

---

## å…­ã€å…³é”®æç¤ºè¯ä¼˜åŒ–

### 6.1 å›¾æ¡ˆç”Ÿæˆæ ¸å¿ƒæç¤ºè¯

```
[SHEIN Kids Pattern Generation]

You are an expert textile designer creating patterns for SHEIN kids clothing.

STYLE REQUIREMENTS:
- Target: Young children 4-7 years old
- Aesthetic: Cute, playful, age-appropriate
- Colors: Vibrant but not overwhelming, pastel-friendly
- Appeal: Must attract both children and parents

PATTERN TYPES:
1. Character/IP Style: Cute animals, cartoon characters, friendly faces
2. Geometric: Hearts, stars, rainbows, polka dots, stripes
3. Text/Letter: Varsity letters, cute phrases, brand-style logos
4. Themed: Dinosaurs, unicorns, space, ocean, sports

TECHNICAL REQUIREMENTS:
- Seamless tileable pattern
- Print-ready resolution (300 DPI equivalent)
- Clear motifs at fabric scale (5-8cm real size)
- No visible repeat seams when tiled

OUTPUT: Generate a seamless pattern tile suitable for children's clothing fabric printing.
```

### 6.2 ç”µå•†å±•ç¤ºå›¾æ ¸å¿ƒæç¤ºè¯

```
[SHEIN E-commerce Product Photo]

You are a professional e-commerce photographer for SHEIN kids clothing.

FLAT LAY STYLE:
- Background: Soft textured surface (white fur, light wood, knit fabric)
- Arrangement: Garment laid flat, slightly angled (30-45 degrees)
- Props: Theme-matching accessories, small toys, decorative items
- Lighting: Soft natural daylight, even illumination, minimal shadows
- Composition: Clean, uncluttered, Instagram-worthy aesthetic

QUALITY STANDARDS:
- High resolution, sharp details
- True-to-life colors
- Professional product photography quality
- Ready for e-commerce listing

MOOD: Fresh, inviting, appealing to young parents shopping online
```

### 6.3 æ¨¡ç‰¹ç”Ÿæˆæ ¸å¿ƒæç¤ºè¯

```
[SHEIN Kids Model Photo]

You are a children's fashion photographer creating SHEIN-style product photos.

MODEL REQUIREMENTS:
- Age: 4-7 years old (Young Girls/Boys category)
- Expression: Natural, happy, age-appropriate
- Pose: Relaxed, playful, not overly posed
- Hair/Styling: Clean, natural, age-appropriate

PHOTO STYLE:
- Lighting: Soft, flattering, even illumination
- Background: Clean studio or lifestyle setting
- Mood: Cheerful, energetic, appealing to parents
- Quality: High-resolution, professional grade

IMPORTANT:
- Child must look natural and comfortable
- Clothing must be clearly visible and well-fitted
- Background should complement but not distract from the garment
```

---

## ä¸ƒã€æ–‡ä»¶ä¿®æ”¹æ¸…å•

| æ–‡ä»¶è·¯å¾„ | ä¿®æ”¹ç±»å‹ | è¯´æ˜ |
|---------|---------|------|
| `constants/sheinPresets.ts` | æ–°å»º | SHEINé£æ ¼é¢„è®¾ |
| `constants/ecomPresets.ts` | æ›´æ–° | æ·»åŠ Flat Layé¢„è®¾ |
| `constants/promptPresets.ts` | æ›´æ–° | æ·»åŠ æ–°å›¾æ¡ˆé¢„è®¾ |
| `constants/system-prompts.ts` | æ›´æ–° | ä¼˜åŒ–ç³»ç»Ÿæç¤ºè¯ |
| `nodes/image/GeminiPatternNode/executor.ts` | æ›´æ–° | é›†æˆæ–°é¢„è®¾ |
| `nodes/image/GeminiEcomNode/executor.ts` | æ›´æ–° | æ·»åŠ å±•ç¤ºæ¨¡å¼ |
| `components/ConfigForms/PatternConfigForm.tsx` | æ›´æ–° | æ·»åŠ é¢„è®¾é€‰æ‹©å™¨ |
| `components/ConfigForms/EcomPresetSelector.tsx` | æ›´æ–° | æ·»åŠ å±•ç¤ºæ¨¡å¼ |

---

## å…«ã€èŠ‚ç‚¹é—´åä½œè®¾è®¡ (1+1=2 æ•ˆæœ)

### 8.1 èŠ‚ç‚¹åä½œæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        èŠ‚ç‚¹åä½œç”Ÿæ€ç³»ç»Ÿ                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ VisionPromptâ”‚â”€â”€â”€â–ºâ”‚ PatternNode â”‚â”€â”€â”€â–ºâ”‚  EditNode   â”‚â”€â”€â”€â–ºâ”‚  EcomNode   â”‚  â”‚
â”‚  â”‚   (åˆ†æ)    â”‚    â”‚  (å›¾æ¡ˆç”Ÿæˆ)  â”‚    â”‚ (Mockupè´´å›¾)â”‚    â”‚ (ç”µå•†å±•ç¤º)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                  â”‚                  â”‚          â”‚
â”‚         â–¼                 â–¼                  â–¼                  â–¼          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ promptJson  â”‚    â”‚ patternTile â”‚    â”‚ mockupImage â”‚    â”‚ finalImage  â”‚  â”‚
â”‚  â”‚ (ç»“æ„åŒ–æ•°æ®) â”‚    â”‚ (æ— ç¼å›¾æ¡ˆ)   â”‚    â”‚ (è´´å›¾æœè£…)   â”‚    â”‚ (ç”µå•†æˆå“)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                       â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                              å…±äº«ä¸Šä¸‹æ–‡                                      â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ModelNode (æ¨¡ç‰¹ç”Ÿæˆ)                          â”‚   â”‚
â”‚  â”‚  å¯ä»ä»»æ„é˜¶æ®µæ¥å…¥ï¼špromptJson / mockupImage / åŸå§‹æœè£…å›¾               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 æ•°æ®æµåè®®è®¾è®¡

#### A. ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡ä¼ é€’æ ¼å¼

```typescript
// èŠ‚ç‚¹é—´å…±äº«çš„ä¸Šä¸‹æ–‡æ•°æ®ç»“æ„
interface WorkflowContext {
  // æœè£…åˆ†æç»“æœ (æ¥è‡ª VisionPrompt)
  garmentAnalysis?: {
    style: string           // é£æ ¼ç±»å‹: 'kawaii' | 'sporty' | 'preppy' | 'ip_theme'
    colors: string[]        // ä¸»è‰²è°ƒ: ['pink', 'white', 'gold']
    patterns: string[]      // å›¾æ¡ˆå…ƒç´ : ['hearts', 'ribbons', 'stars']
    ipCharacter?: string    // IPè§’è‰²: 'Hello Kitty' | 'Garfield'
    targetAge: string       // ç›®æ ‡å¹´é¾„: '4-7' | '8-12'
    targetGender: string    // ç›®æ ‡æ€§åˆ«: 'girl' | 'boy' | 'unisex'
  }

  // å›¾æ¡ˆç”Ÿæˆå‚æ•° (ä¼ é€’ç»™ PatternNode)
  patternParams?: {
    stylePreset: string     // é£æ ¼é¢„è®¾ID
    colorScheme: string[]   // é…è‰²æ–¹æ¡ˆ
    density: string         // å¯†åº¦: 'sparse' | 'medium' | 'dense'
    seamlessMode: boolean   // æ˜¯å¦æ— ç¼
  }

  // è´´å›¾å‚æ•° (ä¼ é€’ç»™ EditNode)
  mockupParams?: {
    printType: string       // å°èŠ±ç±»å‹: 'placement' | 'allover' | 'set'
    printPosition: string   // å°èŠ±ä½ç½®: 'chest' | 'full' | 'pants'
    scaleMode: string       // ç¼©æ”¾æ¨¡å¼: 'auto' | 'tile' | 'fit'
  }

  // å±•ç¤ºå‚æ•° (ä¼ é€’ç»™ EcomNode)
  displayParams?: {
    displayMode: string     // å±•ç¤ºæ¨¡å¼: 'flat_lay' | 'hanger' | 'model'
    background: string      // èƒŒæ™¯é£æ ¼
    props: string[]         // é“å…·åˆ—è¡¨
    lighting: string        // å…‰çº¿é£æ ¼
  }
}
```

#### B. èŠ‚ç‚¹è¾“å‡ºæ ‡å‡†åŒ–

```typescript
// æ¯ä¸ªèŠ‚ç‚¹çš„æ ‡å‡†è¾“å‡ºæ ¼å¼
interface NodeOutput {
  // ä¸»è¦è¾“å‡º
  image?: string           // å•å›¾è¾“å‡º
  images?: string[]        // å¤šå›¾è¾“å‡º

  // å…ƒæ•°æ® (ä¾›ä¸‹æ¸¸èŠ‚ç‚¹ä½¿ç”¨)
  metadata: {
    nodeType: string       // èŠ‚ç‚¹ç±»å‹
    timestamp: number      // ç”Ÿæˆæ—¶é—´
    config: object         // ä½¿ç”¨çš„é…ç½®

    // åˆ†æç»“æœ (VisionPrompt ç‰¹æœ‰)
    analysis?: object

    // å›¾æ¡ˆä¿¡æ¯ (PatternNode ç‰¹æœ‰)
    patternInfo?: {
      seamless: boolean
      colorPalette: string[]
      motifSize: string
    }

    // è´´å›¾ä¿¡æ¯ (EditNode ç‰¹æœ‰)
    mockupInfo?: {
      printType: string
      garmentType: string
    }
  }

  // ä¸Šä¸‹æ–‡ä¼ é€’ (ä¾›ä¸‹æ¸¸èŠ‚ç‚¹ç»§æ‰¿)
  context?: WorkflowContext
}
```

### 8.3 æ™ºèƒ½å‚æ•°ç»§æ‰¿æœºåˆ¶

#### A. VisionPrompt â†’ PatternNode åä½œ

```typescript
// VisionPrompt åˆ†ææœè£…åï¼Œè‡ªåŠ¨æ¨èå›¾æ¡ˆç”Ÿæˆå‚æ•°
function derivePatternParams(analysis: GarmentAnalysis): PatternParams {
  return {
    // æ ¹æ®æœè£…é£æ ¼æ¨èå›¾æ¡ˆç±»å‹
    patternType: mapStyleToPattern(analysis.style),
    // æ ¹æ®æœè£…é¢œè‰²æ¨èé…è‰²
    colorScheme: analysis.colors,
    // æ ¹æ®ç›®æ ‡å¹´é¾„æ¨èå¯†åº¦
    density: analysis.targetAge === '4-7' ? 'medium' : 'dense',
    // æ ¹æ®IPè§’è‰²æ¨èé£æ ¼
    stylePreset: analysis.ipCharacter
      ? `ip_${analysis.ipCharacter.toLowerCase()}`
      : `${analysis.style}_default`
  }
}

// é£æ ¼åˆ°å›¾æ¡ˆç±»å‹çš„æ˜ å°„
const STYLE_TO_PATTERN_MAP = {
  'kawaii': 'cartoon',
  'sporty': 'geometric',
  'preppy': 'geometric',
  'ip_theme': 'cartoon',
  'sweet': 'floral',
  'street': 'abstract'
}
```

#### B. PatternNode â†’ EditNode åä½œ

```typescript
// PatternNode ç”Ÿæˆå›¾æ¡ˆåï¼Œè‡ªåŠ¨æ¨èè´´å›¾å‚æ•°
function deriveMockupParams(patternInfo: PatternInfo, garmentType: string): MockupParams {
  return {
    // æ ¹æ®å›¾æ¡ˆç±»å‹æ¨èå°èŠ±æ–¹å¼
    printType: patternInfo.seamless ? 'allover' : 'placement',
    // æ ¹æ®æœè£…ç±»å‹æ¨èä½ç½®
    printPosition: garmentType === 'pants' ? 'full' : 'chest',
    // æ ¹æ®å›¾æ¡ˆå¯†åº¦æ¨èç¼©æ”¾
    scaleMode: patternInfo.seamless ? 'tile' : 'fit',
    // ä¼ é€’é…è‰²ä¿¡æ¯ç”¨äºæ™ºèƒ½æŸ“è‰²
    dyeColor: patternInfo.colorPalette[0]
  }
}
```

#### C. EditNode â†’ EcomNode åä½œ

```typescript
// EditNode ç”Ÿæˆ Mockup åï¼Œè‡ªåŠ¨æ¨èå±•ç¤ºå‚æ•°
function deriveDisplayParams(mockupInfo: MockupInfo, context: WorkflowContext): DisplayParams {
  const style = context.garmentAnalysis?.style || 'default'

  return {
    // æ ¹æ®æœè£…ç±»å‹æ¨èå±•ç¤ºæ¨¡å¼
    displayMode: mockupInfo.garmentType === 'set' ? 'flat_lay' : 'hanger',
    // æ ¹æ®é£æ ¼æ¨èèƒŒæ™¯
    background: STYLE_TO_BACKGROUND_MAP[style],
    // æ ¹æ®é£æ ¼æ¨èé“å…·
    props: STYLE_TO_PROPS_MAP[style],
    // æ ¹æ®é£æ ¼æ¨èå…‰çº¿
    lighting: style === 'sweet' ? 'warm_soft' : 'neutral_even'
  }
}

// é£æ ¼åˆ°èƒŒæ™¯çš„æ˜ å°„
const STYLE_TO_BACKGROUND_MAP = {
  'kawaii': 'white_fur',
  'sporty': 'wood_texture',
  'preppy': 'gray_gradient',
  'sweet': 'pink_knit',
  'ip_theme': 'themed_scene'
}

// é£æ ¼åˆ°é“å…·çš„æ˜ å°„
const STYLE_TO_PROPS_MAP = {
  'kawaii': ['plush_toy', 'ribbon', 'stars'],
  'sporty': ['ball', 'sneakers', 'cap'],
  'preppy': ['books', 'glasses', 'badge'],
  'sweet': ['flowers', 'hearts', 'candy'],
  'ip_theme': ['ip_toys', 'themed_items']
}
```

### 8.4 æç¤ºè¯ååŒä¼˜åŒ–

#### A. è·¨èŠ‚ç‚¹æç¤ºè¯ä¸€è‡´æ€§

```typescript
// ç¡®ä¿å„èŠ‚ç‚¹æç¤ºè¯é£æ ¼ä¸€è‡´çš„åŸºç¡€æ¨¡æ¿
const UNIFIED_STYLE_KEYWORDS = {
  shein: {
    quality: 'professional e-commerce quality, SHEIN standard',
    mood: 'young, trendy, Instagram-worthy',
    target: 'young parents shopping for kids 4-7 years old'
  },
  temu: {
    quality: 'clear product visibility, value-focused',
    mood: 'practical, trustworthy, detail-oriented',
    target: 'budget-conscious shoppers'
  }
}

// å„èŠ‚ç‚¹ä½¿ç”¨ç»Ÿä¸€çš„é£æ ¼å…³é”®è¯
function buildUnifiedPrompt(nodeType: string, platform: string): string {
  const keywords = UNIFIED_STYLE_KEYWORDS[platform]

  const basePrompt = `
[Platform Style: ${platform.toUpperCase()}]
Quality Standard: ${keywords.quality}
Mood & Aesthetic: ${keywords.mood}
Target Audience: ${keywords.target}
`
  return basePrompt
}
```

#### B. ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æç¤ºè¯å¢å¼º

```typescript
// PatternNode æ„ŸçŸ¥ VisionPrompt çš„åˆ†æç»“æœ
function enhancePatternPrompt(basePrompt: string, context: WorkflowContext): string {
  if (!context.garmentAnalysis) return basePrompt

  const analysis = context.garmentAnalysis

  return `${basePrompt}

[Context from Garment Analysis]
- Detected Style: ${analysis.style}
- Color Palette: ${analysis.colors.join(', ')}
- Pattern Elements: ${analysis.patterns.join(', ')}
${analysis.ipCharacter ? `- IP Character: ${analysis.ipCharacter}` : ''}

[Coordination Requirement]
Generate a pattern that harmonizes with the detected garment style.
Maintain color consistency with the original garment.
${analysis.ipCharacter ? `Include elements inspired by ${analysis.ipCharacter} character.` : ''}
`
}

// EcomNode æ„ŸçŸ¥æ•´ä¸ªæµæ°´çº¿çš„ä¸Šä¸‹æ–‡
function enhanceEcomPrompt(basePrompt: string, context: WorkflowContext): string {
  const parts = [basePrompt]

  if (context.garmentAnalysis) {
    parts.push(`
[Garment Context]
Style: ${context.garmentAnalysis.style}
Target: ${context.garmentAnalysis.targetAge} ${context.garmentAnalysis.targetGender}
`)
  }

  if (context.patternParams) {
    parts.push(`
[Pattern Context]
Style Preset: ${context.patternParams.stylePreset}
Color Scheme: ${context.patternParams.colorScheme.join(', ')}
`)
  }

  parts.push(`
[Coordination Requirement]
Ensure the final e-commerce photo reflects all upstream design decisions.
Props and background should complement the garment's style and pattern.
Maintain visual consistency throughout the product presentation.
`)

  return parts.join('\n')
}
```

### 8.5 åä½œæ•ˆæœéªŒè¯æ¸…å•

| åä½œè·¯å¾„ | é¢„æœŸæ•ˆæœ | éªŒè¯æ–¹æ³• |
|---------|---------|---------|
| VisionPrompt â†’ PatternNode | å›¾æ¡ˆé£æ ¼ä¸æœè£…åˆ†æä¸€è‡´ | å¯¹æ¯”åˆ†æç»“æœå’Œç”Ÿæˆå›¾æ¡ˆ |
| PatternNode â†’ EditNode | è´´å›¾æ¯”ä¾‹å’Œä½ç½®åˆç† | æ£€æŸ¥å›¾æ¡ˆåœ¨æœè£…ä¸Šçš„å‘ˆç° |
| EditNode â†’ EcomNode | å±•ç¤ºé£æ ¼ä¸æœè£…ä¸»é¢˜åŒ¹é… | æ£€æŸ¥èƒŒæ™¯é“å…·æ˜¯å¦åè°ƒ |
| å…¨æµç¨‹ â†’ ModelNode | æ¨¡ç‰¹é£æ ¼ä¸æ•´ä½“ä¸€è‡´ | æ£€æŸ¥æ¨¡ç‰¹å¹´é¾„ã€å§¿æ€ã€åœºæ™¯ |

### 8.6 å®ç°ä¼˜å…ˆçº§

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | å¤æ‚åº¦ | è¯´æ˜ |
|-----|-------|-------|------|
| ç»Ÿä¸€ä¸Šä¸‹æ–‡æ•°æ®ç»“æ„ | P0 | ä¸­ | å®šä¹‰ WorkflowContext æ¥å£ |
| èŠ‚ç‚¹è¾“å‡ºæ ‡å‡†åŒ– | P0 | ä½ | ç»Ÿä¸€ metadata æ ¼å¼ |
| VisionPrompt â†’ PatternNode åä½œ | P1 | ä¸­ | å®ç°å‚æ•°æ¨å¯¼é€»è¾‘ |
| PatternNode â†’ EditNode åä½œ | P1 | ä¸­ | å®ç°è´´å›¾å‚æ•°æ¨å¯¼ |
| EditNode â†’ EcomNode åä½œ | P1 | ä¸­ | å®ç°å±•ç¤ºå‚æ•°æ¨å¯¼ |
| è·¨èŠ‚ç‚¹æç¤ºè¯ä¸€è‡´æ€§ | P2 | ä½ | ç»Ÿä¸€é£æ ¼å…³é”®è¯ |
| ä¸Šä¸‹æ–‡æ„ŸçŸ¥æç¤ºè¯å¢å¼º | P2 | é«˜ | å®ç°åŠ¨æ€æç¤ºè¯ç”Ÿæˆ |

---

## ä¹ã€å®Œæ•´å·¥ä½œæµæ¨¡æ¿

### 9.1 SHEIN ç«¥è£…çˆ†æ¬¾ç”Ÿæˆæµç¨‹

```yaml
name: SHEIN Kids Bestseller Generator
description: ä»åˆ›æ„åˆ°ç”µå•†æˆå“çš„å®Œæ•´æµæ°´çº¿

nodes:
  - id: input
    type: image_input
    config:
      label: "å‚è€ƒå›¾ç‰‡/çµæ„Ÿå›¾"

  - id: vision_analysis
    type: vision_prompt
    inputs:
      image: input.image
    config:
      styleMode: daily
      ageGroup: small_kid
      gender: female

  - id: pattern_gen
    type: gemini_pattern
    inputs:
      reference: input.image
      context: vision_analysis.promptJson
    config:
      patternType: seamless
      stylePreset: auto  # æ ¹æ®åˆ†æè‡ªåŠ¨é€‰æ‹©
      density: medium
      colorTone: auto    # æ ¹æ®åˆ†æè‡ªåŠ¨é€‰æ‹©

  - id: mockup_top
    type: gemini_edit
    inputs:
      garment: base_tshirt.image
      pattern: pattern_gen.patternImage
    config:
      editMode: placement_print
      position: chest

  - id: mockup_pants
    type: gemini_edit
    inputs:
      garment: base_pants.image
      pattern: pattern_gen.patternImage
    config:
      editMode: allover_print
      scaleMode: tile

  - id: ecom_display
    type: gemini_ecom
    inputs:
      top: mockup_top.image
      bottom: mockup_pants.image
    config:
      layout: flat_lay
      stylePreset: auto  # æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨é€‰æ‹©
      fillMode: filled

  - id: model_photo
    type: gemini_model
    inputs:
      promptJson: vision_analysis.promptJson
      garmentImages: [mockup_top.image, mockup_pants.image]
    config:
      ageGroup: small_kid
      gender: female
      scenePreset: home

outputs:
  - pattern: pattern_gen.patternImage
  - mockup_set: [mockup_top.image, mockup_pants.image]
  - ecom_photo: ecom_display.images
  - model_photo: model_photo.modelImage
```

### 9.2 å¿«é€Ÿå•å“ç”Ÿæˆæµç¨‹

```yaml
name: Quick Single Item Generator
description: å¿«é€Ÿç”Ÿæˆå•å“ç”µå•†å›¾

nodes:
  - id: pattern_gen
    type: gemini_pattern
    config:
      patternType: tshirt_front
      stylePreset: ip_kawaii_animal

  - id: mockup
    type: gemini_edit
    inputs:
      garment: base_tshirt.image
      graphic: pattern_gen.graphicImage
    config:
      editMode: placement_print

  - id: ecom_display
    type: gemini_ecom
    inputs:
      garment: mockup.image
    config:
      layout: hanger
      stylePreset: shein

outputs:
  - graphic: pattern_gen.graphicImage
  - mockup: mockup.image
  - ecom_photo: ecom_display.images
```

---

---

## åã€ç»Ÿä¸€JSONæç¤ºè¯ç³»ç»Ÿè®¾è®¡

### 10.1 è®¾è®¡ç›®æ ‡

å°†VisionPromptèŠ‚ç‚¹å‡çº§ä¸º**ç»Ÿä¸€æç¤ºè¯ç”Ÿæˆä¸­å¿ƒ**ï¼Œæ”¯æŒä¸‰ç§è¾“å‡ºæ¨¡å¼ï¼š
- **æ¨¡ç‰¹æç¤ºè¯JSON** - ç”¨äºGeminiModelNodeç”Ÿæˆæ¨¡ç‰¹å›¾
- **å›¾æ¡ˆæç¤ºè¯JSON** - ç”¨äºGeminiPatternNodeç”Ÿæˆå›¾æ¡ˆ
- **ç”µå•†å›¾æç¤ºè¯JSON** - ç”¨äºGeminiEcomNodeç”Ÿæˆç”µå•†å±•ç¤ºå›¾

### 10.2 JSON Schema å®šä¹‰

#### A. æ¨¡ç‰¹æç¤ºè¯JSON (ç°æœ‰æ ¼å¼æ‰©å±•)

```typescript
interface ModelPromptJson {
  // åŸºç¡€ä¿¡æ¯
  type: 'model'
  version: '2.0'

  // æ¨¡ç‰¹æè¿°
  age_years: number
  gender: 'male' | 'female'
  age_group: 'small_kid' | 'big_kid' | 'adult'
  ethnicity: string
  appearance: string

  // æœè£…æè¿°
  subject: string
  garment_style: string
  garment_colors: string[]

  // åœºæ™¯æè¿°
  scene_preset: string
  foreground: string
  midground: string
  background: string

  // æŠ€æœ¯å‚æ•°
  composition: string
  visual_guidance: string
  color_tone: string
  lighting_mood: string
  camera_params: string

  // é™„åŠ ä¿¡æ¯
  has_hat: boolean
  has_mask: boolean
  ip_brand?: string
  ip_desc?: string

  // è¾“å‡ºæç¤ºè¯
  caption: string
  video_prompt: string
}
```

#### B. å›¾æ¡ˆæç¤ºè¯JSON (æ–°å¢)

```typescript
interface PatternPromptJson {
  // åŸºç¡€ä¿¡æ¯
  type: 'pattern'
  version: '1.0'

  // å›¾æ¡ˆé£æ ¼
  pattern_style: string           // 'kawaii' | 'sporty' | 'preppy' | 'ip_theme' | 'sweet'
  pattern_type: string            // 'seamless' | 'placement' | 'allover'
  target_gender: 'girl' | 'boy' | 'unisex'
  target_age: string              // '4-7' | '8-12' | 'adult'

  // å…ƒç´ æè¿°
  main_elements: string[]         // ['hearts', 'stars', 'animals']
  secondary_elements: string[]    // ['sparkles', 'dots', 'ribbons']
  ip_character?: string           // 'Hello Kitty' | 'Garfield' | null

  // è‰²å½©æ–¹æ¡ˆ
  color_palette: string[]         // ['#FF69B4', '#FFFFFF', '#FFD700']
  color_mood: string              // 'pastel' | 'vibrant' | 'muted' | 'neon'
  background_color: string        // '#FFFFFF'

  // å¸ƒå±€å‚æ•°
  density: 'sparse' | 'medium' | 'dense'
  symmetry: 'none' | 'horizontal' | 'vertical' | 'radial'
  scale: 'small' | 'medium' | 'large'

  // æŠ€æœ¯è¦æ±‚
  seamless_required: boolean
  print_ready: boolean
  resolution_hint: string         // '1024x1024' | '2048x2048'

  // ç”Ÿæˆæç¤ºè¯
  style_prompt: string            // å®Œæ•´çš„é£æ ¼æè¿°
  element_prompt: string          // å…ƒç´ æè¿°
  technical_prompt: string        // æŠ€æœ¯è¦æ±‚
  full_prompt: string             // åˆå¹¶åçš„å®Œæ•´æç¤ºè¯
}
```

#### C. ç”µå•†å›¾æç¤ºè¯JSON (æ–°å¢)

```typescript
interface EcomPromptJson {
  // åŸºç¡€ä¿¡æ¯
  type: 'ecom'
  version: '1.0'

  // å±•ç¤ºæ¨¡å¼
  display_mode: 'flat_lay' | 'hanger' | 'scene' | 'model'
  platform_style: 'shein' | 'temu' | 'amazon' | 'taobao' | 'xiaohongshu'

  // æœè£…ä¿¡æ¯ (ä»å›¾ç‰‡åˆ†æ)
  garment_type: string            // 'set' | 'top' | 'bottom' | 'dress'
  garment_style: string           // 'kawaii' | 'sporty' | 'preppy'
  garment_colors: string[]
  has_print: boolean
  print_description?: string

  // èƒŒæ™¯è®¾ç½®
  background_type: string         // 'white_fur' | 'wood_texture' | 'colored_wall'
  background_color?: string

  // é“å…·æ¨è
  suggested_props: string[]       // ['plush_toy', 'ribbon', 'flowers']
  prop_placement: string          // 'corners' | 'sides' | 'scattered'

  // å…‰çº¿è®¾ç½®
  lighting_style: string          // 'natural_soft' | 'studio_even' | 'warm_ambient'
  shadow_style: string            // 'minimal' | 'soft' | 'dramatic'

  // æ„å›¾å‚æ•°
  composition: string             // '45_degree' | 'top_down' | 'front_straight'
  garment_angle: number           // 0-45 åº¦
  fill_mode: 'filled' | 'flat'    // Ghost Mannequin æ•ˆæœ

  // ç”Ÿæˆæç¤ºè¯
  background_prompt: string
  props_prompt: string
  lighting_prompt: string
  composition_prompt: string
  full_prompt: string             // åˆå¹¶åçš„å®Œæ•´æç¤ºè¯
}
```

### 10.3 VisionPrompt èŠ‚ç‚¹å‡çº§è®¾è®¡

#### A. æ–°å¢é…ç½®é¡¹

```typescript
// åœ¨ configSchema.fields ä¸­æ·»åŠ 
{
  key: 'outputMode',
  label: 'è¾“å‡ºæ¨¡å¼',
  type: 'select',
  required: true,
  default: 'model',
  options: [
    { label: 'æ¨¡ç‰¹æç¤ºè¯', value: 'model' },
    { label: 'å›¾æ¡ˆæç¤ºè¯', value: 'pattern' },
    { label: 'ç”µå•†å›¾æç¤ºè¯', value: 'ecom' },
    { label: 'å…¨éƒ¨è¾“å‡º', value: 'all' }
  ],
  description: 'é€‰æ‹©ç”Ÿæˆçš„æç¤ºè¯ç±»å‹'
}
```

#### B. æ–°å¢è¾“å‡ºç«¯å£

```typescript
outputs: [
  // ç°æœ‰è¾“å‡º
  { id: 'promptJson', label: 'æç¤ºè¯ JSON', dataType: 'json' },
  { id: 'caption', label: 'å›¾ç‰‡æè¿°', dataType: 'text' },
  { id: 'videoPrompt', label: 'è§†é¢‘æç¤ºè¯', dataType: 'text' },

  // æ–°å¢è¾“å‡º
  { id: 'modelPromptJson', label: 'æ¨¡ç‰¹æç¤ºè¯', dataType: 'json' },
  { id: 'patternPromptJson', label: 'å›¾æ¡ˆæç¤ºè¯', dataType: 'json' },
  { id: 'ecomPromptJson', label: 'ç”µå•†å›¾æç¤ºè¯', dataType: 'json' }
]
```

#### C. ç³»ç»Ÿæç¤ºè¯æ¨¡æ¿

```typescript
// å›¾æ¡ˆåˆ†æç³»ç»Ÿæç¤ºè¯
const PATTERN_ANALYSIS_PROMPT = `
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ç«¥è£…å›¾æ¡ˆè®¾è®¡å¸ˆå’Œçººç»‡å“ä¸“å®¶ã€‚
åˆ†æè¾“å…¥çš„æœè£…å›¾ç‰‡ï¼Œæå–å›¾æ¡ˆè®¾è®¡ç›¸å…³ä¿¡æ¯ï¼Œç”Ÿæˆç”¨äºAIå›¾æ¡ˆç”Ÿæˆçš„ç»“æ„åŒ–JSONã€‚

# åˆ†æè¦ç‚¹
1. è¯†åˆ«å›¾æ¡ˆé£æ ¼ï¼ˆå¯çˆ±/è¿åŠ¨/å­¦é™¢/IPä¸»é¢˜/ç”œç¾ç­‰ï¼‰
2. æå–ä¸»è¦å›¾æ¡ˆå…ƒç´ ï¼ˆçˆ±å¿ƒã€æ˜Ÿæ˜Ÿã€åŠ¨ç‰©ã€æ–‡å­—ç­‰ï¼‰
3. åˆ†æè‰²å½©æ–¹æ¡ˆï¼ˆä¸»è‰²ã€è¾…è‰²ã€èƒŒæ™¯è‰²ï¼‰
4. åˆ¤æ–­å›¾æ¡ˆå¯†åº¦å’Œå¸ƒå±€ç‰¹ç‚¹
5. è¯†åˆ«æ˜¯å¦ä¸ºIPè§’è‰²å›¾æ¡ˆ

# JSON è¾“å‡ºæ ¼å¼
{
  "type": "pattern",
  "version": "1.0",
  "pattern_style": "...",
  "pattern_type": "seamless|placement|allover",
  "target_gender": "girl|boy|unisex",
  "target_age": "4-7|8-12|adult",
  "main_elements": ["..."],
  "secondary_elements": ["..."],
  "ip_character": "...|null",
  "color_palette": ["#...", "#..."],
  "color_mood": "pastel|vibrant|muted|neon",
  "background_color": "#...",
  "density": "sparse|medium|dense",
  "symmetry": "none|horizontal|vertical|radial",
  "scale": "small|medium|large",
  "seamless_required": true|false,
  "print_ready": true,
  "resolution_hint": "1024x1024",
  "style_prompt": "...",
  "element_prompt": "...",
  "technical_prompt": "...",
  "full_prompt": "..."
}
`

// ç”µå•†å›¾åˆ†æç³»ç»Ÿæç¤ºè¯
const ECOM_ANALYSIS_PROMPT = `
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ç”µå•†äº§å“æ‘„å½±å¸ˆå’Œè§†è§‰è¥é”€ä¸“å®¶ã€‚
åˆ†æè¾“å…¥çš„æœè£…å›¾ç‰‡ï¼Œç”Ÿæˆç”¨äºAIç”µå•†å›¾ç”Ÿæˆçš„ç»“æ„åŒ–JSONã€‚

# åˆ†æè¦ç‚¹
1. è¯†åˆ«æœè£…ç±»å‹ï¼ˆå¥—è£…/ä¸Šè¡£/ä¸‹è£…/è¿è¡£è£™ï¼‰
2. åˆ†ææœè£…é£æ ¼å’Œç›®æ ‡å—ä¼—
3. æ¨èæœ€ä½³å±•ç¤ºæ¨¡å¼ï¼ˆå¹³é“º/æŒ‚æ‹/åœºæ™¯ï¼‰
4. æ¨èèƒŒæ™¯å’Œé“å…·æ­é…
5. è®¾è®¡å…‰çº¿å’Œæ„å›¾æ–¹æ¡ˆ

# JSON è¾“å‡ºæ ¼å¼
{
  "type": "ecom",
  "version": "1.0",
  "display_mode": "flat_lay|hanger|scene|model",
  "platform_style": "shein|temu|amazon",
  "garment_type": "set|top|bottom|dress",
  "garment_style": "...",
  "garment_colors": ["..."],
  "has_print": true|false,
  "print_description": "...",
  "background_type": "white_fur|wood_texture|colored_wall",
  "background_color": "#...",
  "suggested_props": ["..."],
  "prop_placement": "corners|sides|scattered",
  "lighting_style": "natural_soft|studio_even|warm_ambient",
  "shadow_style": "minimal|soft|dramatic",
  "composition": "45_degree|top_down|front_straight",
  "garment_angle": 30,
  "fill_mode": "filled|flat",
  "background_prompt": "...",
  "props_prompt": "...",
  "lighting_prompt": "...",
  "composition_prompt": "...",
  "full_prompt": "..."
}
`
```

### 10.4 ä¸‹æ¸¸èŠ‚ç‚¹æ¥å£è®¾è®¡

#### A. GeminiPatternNode æ¥æ”¶ patternPromptJson

```typescript
// æ–°å¢è¾“å…¥ç«¯å£
inputs: [
  { id: 'reference', label: 'å‚è€ƒå›¾ç‰‡', dataType: 'image', required: false },
  { id: 'patternPromptJson', label: 'å›¾æ¡ˆæç¤ºè¯', dataType: 'json', required: false }
]

// æ‰§è¡Œå™¨ä¸­å¤„ç†
async execute(inputs, config, context) {
  // å¦‚æœæœ‰ patternPromptJson è¾“å…¥ï¼Œä¼˜å…ˆä½¿ç”¨
  if (inputs.patternPromptJson) {
    const json = inputs.patternPromptJson as PatternPromptJson
    // ä» JSON æ„å»ºæç¤ºè¯
    const prompt = this.buildPromptFromJson(json)
    // ä½¿ç”¨ JSON ä¸­çš„é…ç½®è¦†ç›–é»˜è®¤é…ç½®
    config = { ...config, ...this.extractConfigFromJson(json) }
  }
  // ... ç»§ç»­æ‰§è¡Œ
}
```

#### B. GeminiEcomNode æ¥æ”¶ ecomPromptJson

```typescript
// æ–°å¢è¾“å…¥ç«¯å£
inputs: [
  { id: 'top', label: 'ä¸Šè¡£å›¾ç‰‡', dataType: 'image', required: true },
  { id: 'bottom', label: 'ä¸‹è£…å›¾ç‰‡', dataType: 'image', required: false },
  { id: 'ecomPromptJson', label: 'ç”µå•†å›¾æç¤ºè¯', dataType: 'json', required: false }
]

// æ‰§è¡Œå™¨ä¸­å¤„ç†
async execute(inputs, config, context) {
  // å¦‚æœæœ‰ ecomPromptJson è¾“å…¥ï¼Œä¼˜å…ˆä½¿ç”¨
  if (inputs.ecomPromptJson) {
    const json = inputs.ecomPromptJson as EcomPromptJson
    // ä» JSON æ„å»ºæç¤ºè¯
    const prompt = this.buildPromptFromJson(json)
    // ä½¿ç”¨ JSON ä¸­çš„é…ç½®
    config = {
      ...config,
      layout: json.display_mode,
      stylePreset: json.platform_style,
      fillMode: json.fill_mode
    }
  }
  // ... ç»§ç»­æ‰§è¡Œ
}
```

### 10.5 å·¥ä½œæµç¤ºä¾‹

```yaml
name: æ™ºèƒ½ç«¥è£…ç”µå•†æµæ°´çº¿
description: ä½¿ç”¨ç»Ÿä¸€JSONæç¤ºè¯ç³»ç»Ÿçš„å®Œæ•´æµæ°´çº¿

nodes:
  - id: input
    type: image_input

  # åˆ†ææœè£…ï¼Œç”Ÿæˆä¸‰ç§æç¤ºè¯
  - id: vision_analysis
    type: vision_prompt
    inputs:
      image_1: input.image
    config:
      outputMode: all  # è¾“å‡ºæ‰€æœ‰ç±»å‹çš„æç¤ºè¯

  # ä½¿ç”¨å›¾æ¡ˆæç¤ºè¯ç”Ÿæˆæ–°å›¾æ¡ˆ
  - id: pattern_gen
    type: gemini_pattern
    inputs:
      reference: input.image
      patternPromptJson: vision_analysis.patternPromptJson

  # ä½¿ç”¨ç”µå•†å›¾æç¤ºè¯ç”Ÿæˆå±•ç¤ºå›¾
  - id: ecom_display
    type: gemini_ecom
    inputs:
      top: mockup.image
      ecomPromptJson: vision_analysis.ecomPromptJson

  # ä½¿ç”¨æ¨¡ç‰¹æç¤ºè¯ç”Ÿæˆæ¨¡ç‰¹å›¾
  - id: model_photo
    type: gemini_model
    inputs:
      promptJson: vision_analysis.modelPromptJson
      garmentImages: [mockup.image]
```

### 10.6 åˆå¹¶æç¤ºè¯èŠ‚ç‚¹è®¾è®¡

#### ç°çŠ¶åˆ†æ

å½“å‰æœ‰ä¸¤ä¸ªåŠŸèƒ½ç›¸ä¼¼çš„æç¤ºè¯èŠ‚ç‚¹ï¼š
- **VisionPromptNode** - ä½¿ç”¨è§†è§‰æ¨¡å‹åˆ†æå›¾ç‰‡
- **QwenPromptNode** - ä½¿ç”¨ Qwen æ¨¡å‹åˆ†æå›¾ç‰‡

ä¸¤è€…è¾“å…¥è¾“å‡ºå‡ ä¹ç›¸åŒï¼Œåªæ˜¯ä½¿ç”¨çš„æ¨¡å‹ä¸åŒã€‚

#### åˆå¹¶æ–¹æ¡ˆï¼šç»Ÿä¸€æç¤ºè¯èŠ‚ç‚¹ (UnifiedPromptNode)

```typescript
// nodes/ai/UnifiedPromptNode/index.ts

export const UnifiedPromptNode: NodeDefinition = {
  metadata: {
    type: 'unified_prompt',
    label: 'æ™ºèƒ½æç¤ºè¯',
    icon: 'ğŸ¯',
    category: 'ai',
    version: '2.0.0',
    description: 'ç»Ÿä¸€çš„AIæç¤ºè¯ç”ŸæˆèŠ‚ç‚¹ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ¨¡å¼'
  },

  inputs: [
    { id: 'image_1', label: 'å›¾ç‰‡ 1 (ä¸»å›¾)', dataType: 'image', required: true },
    { id: 'image_2', label: 'å›¾ç‰‡ 2 (å¯é€‰)', dataType: 'image', required: false },
    { id: 'image_3', label: 'å›¾ç‰‡ 3 (å¯é€‰)', dataType: 'image', required: false }
  ],

  outputs: [
    // é€šç”¨è¾“å‡º
    { id: 'promptJson', label: 'æç¤ºè¯ JSON', dataType: 'json' },
    { id: 'caption', label: 'æè¿°æ–‡æœ¬', dataType: 'text' },
    { id: 'videoPrompt', label: 'è§†é¢‘æç¤ºè¯', dataType: 'text' },

    // ä¸“ç”¨è¾“å‡º (æ ¹æ® outputMode æ¿€æ´»)
    { id: 'modelPromptJson', label: 'æ¨¡ç‰¹æç¤ºè¯', dataType: 'json' },
    { id: 'patternPromptJson', label: 'å›¾æ¡ˆæç¤ºè¯', dataType: 'json' },
    { id: 'ecomPromptJson', label: 'ç”µå•†å›¾æç¤ºè¯', dataType: 'json' }
  ],

  configSchema: {
    fields: [
      // ========== æ¨¡å‹é€‰æ‹© ==========
      {
        key: 'modelProvider',
        label: 'æ¨¡å‹ç±»å‹',
        type: 'select',
        default: 'auto',
        options: [
          { label: 'è‡ªåŠ¨é€‰æ‹©', value: 'auto' },
          { label: 'Gemini Vision', value: 'gemini' },
          { label: 'Qwen VL', value: 'qwen' },
          { label: 'GPT-4 Vision', value: 'gpt4v' }
        ]
      },
      {
        key: 'providerId',
        label: 'æ¨¡å‹æœåŠ¡',
        type: 'model-selector',
        required: false
      },

      // ========== è¾“å‡ºæ¨¡å¼ (æ ¸å¿ƒ) ==========
      {
        key: 'outputMode',
        label: 'è¾“å‡ºæ¨¡å¼',
        type: 'select',
        default: 'model',
        options: [
          { label: 'ğŸ§‘ æ¨¡ç‰¹æç¤ºè¯', value: 'model' },
          { label: 'ğŸ¨ å›¾æ¡ˆæç¤ºè¯', value: 'pattern' },
          { label: 'ğŸ“¸ ç”µå•†å›¾æç¤ºè¯', value: 'ecom' },
          { label: 'ğŸ“¦ å…¨éƒ¨è¾“å‡º', value: 'all' }
        ],
        description: 'é€‰æ‹©ç”Ÿæˆçš„æç¤ºè¯ç±»å‹ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç³»ç»Ÿæç¤ºè¯'
      },

      // ========== é€šç”¨é…ç½® ==========
      {
        key: 'ageGroup',
        label: 'å¹´é¾„æ®µ',
        type: 'select',
        default: 'small_kid',
        options: [
          { label: 'Young Girls/Boys (4-7å²)', value: 'small_kid' },
          { label: 'Kids (8-12å²)', value: 'big_kid' },
          { label: 'æˆäºº', value: 'adult' }
        ]
      },
      {
        key: 'gender',
        label: 'æ€§åˆ«',
        type: 'select',
        default: 'female',
        options: [
          { label: 'å¥³', value: 'female' },
          { label: 'ç”·', value: 'male' }
        ]
      },

      // ========== æ¨¡ç‰¹æ¨¡å¼ä¸“ç”¨ ==========
      {
        key: 'styleMode',
        label: 'é£æ ¼æ¨¡å¼',
        type: 'select',
        default: 'daily',
        options: [
          { label: 'æ—¥å¸¸æ„Ÿ (iPhoneç¾å­¦)', value: 'daily' },
          { label: 'å•†æ‹æ„Ÿ (ä¸“ä¸šæ‘„å½±)', value: 'commercial' }
        ],
        showWhen: { field: 'outputMode', value: ['model', 'all'] }
      },
      {
        key: 'scenePreset',
        label: 'åœºæ™¯é¢„è®¾',
        type: 'select',
        default: 'home',
        options: [
          { label: 'å®¤å†…å®¶å±…', value: 'home' },
          { label: 'æˆ·å¤–åœºæ™¯', value: 'outdoor' },
          { label: 'æ‘„å½±æ£š', value: 'studio' }
        ],
        showWhen: { field: 'outputMode', value: ['model', 'all'] }
      },
      {
        key: 'ethnicityPreset',
        label: 'äººç§é¢„è®¾',
        type: 'select',
        default: 'asian',
        options: [
          { label: 'äºšæ´²äºº', value: 'asian' },
          { label: 'æ¬§ç¾ç™½äºº', value: 'caucasian' },
          { label: 'éè£”', value: 'african_american' },
          { label: 'æ··è¡€', value: 'mixed' }
        ],
        showWhen: { field: 'outputMode', value: ['model', 'all'] }
      },

      // ========== å›¾æ¡ˆæ¨¡å¼ä¸“ç”¨ ==========
      {
        key: 'patternType',
        label: 'å›¾æ¡ˆç±»å‹',
        type: 'select',
        default: 'seamless',
        options: [
          { label: 'æ— ç¼å¹³é“º', value: 'seamless' },
          { label: 'èƒ¸å‰å¤§å›¾', value: 'placement' },
          { label: 'å…¨èº«å°èŠ±', value: 'allover' }
        ],
        showWhen: { field: 'outputMode', value: ['pattern', 'all'] }
      },
      {
        key: 'patternStyle',
        label: 'å›¾æ¡ˆé£æ ¼',
        type: 'select',
        default: 'auto',
        options: [
          { label: 'è‡ªåŠ¨è¯†åˆ«', value: 'auto' },
          { label: 'Kawaiiå¯çˆ±', value: 'kawaii' },
          { label: 'è¿åŠ¨æ´»åŠ›', value: 'sporty' },
          { label: 'å­¦é™¢é£', value: 'preppy' },
          { label: 'IPä¸»é¢˜', value: 'ip_theme' },
          { label: 'ç”œç¾é£', value: 'sweet' }
        ],
        showWhen: { field: 'outputMode', value: ['pattern', 'all'] }
      },

      // ========== ç”µå•†å›¾æ¨¡å¼ä¸“ç”¨ ==========
      {
        key: 'displayMode',
        label: 'å±•ç¤ºæ¨¡å¼',
        type: 'select',
        default: 'flat_lay',
        options: [
          { label: 'Flat Lay å¹³é“º', value: 'flat_lay' },
          { label: 'æŒ‚æ‹å±•ç¤º', value: 'hanger' },
          { label: 'åœºæ™¯æ­é…', value: 'scene' }
        ],
        showWhen: { field: 'outputMode', value: ['ecom', 'all'] }
      },
      {
        key: 'platformStyle',
        label: 'å¹³å°é£æ ¼',
        type: 'select',
        default: 'shein',
        options: [
          { label: 'SHEIN', value: 'shein' },
          { label: 'TEMU', value: 'temu' },
          { label: 'Amazon', value: 'amazon' },
          { label: 'æ·˜å®', value: 'taobao' },
          { label: 'å°çº¢ä¹¦', value: 'xiaohongshu' }
        ],
        showWhen: { field: 'outputMode', value: ['ecom', 'all'] }
      },

      // ========== é€šç”¨é«˜çº§é…ç½® ==========
      {
        key: 'constraintPrompt',
        label: 'çº¦æŸæç¤ºè¯',
        type: 'textarea',
        required: false,
        placeholder: 'è‡ªå®šä¹‰çº¦æŸæ¡ä»¶...'
      },
      {
        key: 'temperature',
        label: 'åˆ›æ„åº¦',
        type: 'number',
        default: 0.7,
        min: 0,
        max: 2,
        step: 0.1
      }
    ]
  }
}
```

#### æ‰§è¡Œå™¨è®¾è®¡

```typescript
// nodes/ai/UnifiedPromptNode/executor.ts

export class UnifiedPromptExecutor extends BaseNodeExecutor {
  constructor() {
    super('unified_prompt')
  }

  async execute(inputs, config, context) {
    const outputMode = config.outputMode || 'model'

    // æ ¹æ® outputMode é€‰æ‹©ç³»ç»Ÿæç¤ºè¯
    const systemPrompt = this.getSystemPrompt(outputMode, config)

    // è°ƒç”¨è§†è§‰æ¨¡å‹
    const result = await this.callVisionModel(inputs, systemPrompt, config)

    // è§£æ JSON ç»“æœ
    const json = this.parseJsonResponse(result)

    // æ ¹æ® outputMode æ„å»ºè¾“å‡º
    return this.buildOutput(json, outputMode)
  }

  private getSystemPrompt(mode: string, config: any): string {
    switch (mode) {
      case 'model':
        return this.buildModelSystemPrompt(config)
      case 'pattern':
        return this.buildPatternSystemPrompt(config)
      case 'ecom':
        return this.buildEcomSystemPrompt(config)
      case 'all':
        return this.buildAllModesSystemPrompt(config)
      default:
        return this.buildModelSystemPrompt(config)
    }
  }

  private buildOutput(json: any, mode: string) {
    const outputs: Record<string, any> = {
      promptJson: json,
      caption: json.caption || json.full_prompt || '',
      videoPrompt: json.video_prompt || ''
    }

    // æ ¹æ®æ¨¡å¼è®¾ç½®ä¸“ç”¨è¾“å‡º
    if (mode === 'model' || mode === 'all') {
      outputs.modelPromptJson = json.type === 'model' ? json : this.extractModelJson(json)
    }
    if (mode === 'pattern' || mode === 'all') {
      outputs.patternPromptJson = json.type === 'pattern' ? json : this.extractPatternJson(json)
    }
    if (mode === 'ecom' || mode === 'all') {
      outputs.ecomPromptJson = json.type === 'ecom' ? json : this.extractEcomJson(json)
    }

    return this.success(outputs)
  }
}
```

### 10.7 è¿ç§»è®¡åˆ’

| é˜¶æ®µ | ä»»åŠ¡ | è¯´æ˜ |
|-----|------|------|
| Phase 1 | åˆ›å»º UnifiedPromptNode | æ–°å»ºç»Ÿä¸€èŠ‚ç‚¹ï¼Œä¿ç•™æ—§èŠ‚ç‚¹ |
| Phase 2 | æ·»åŠ ä¸‰ç§è¾“å‡ºæ¨¡å¼ | å®ç° model/pattern/ecom ç³»ç»Ÿæç¤ºè¯ |
| Phase 3 | æµ‹è¯•æ–°èŠ‚ç‚¹ | éªŒè¯å„æ¨¡å¼è¾“å‡ºæ­£ç¡® |
| Phase 4 | æ ‡è®°æ—§èŠ‚ç‚¹ deprecated | VisionPromptNode, QwenPromptNode |
| Phase 5 | è¿ç§»ç°æœ‰å·¥ä½œæµ | æä¾›è¿ç§»å·¥å…·æˆ–æŒ‡å— |
| Phase 6 | ç§»é™¤æ—§èŠ‚ç‚¹ | æ¸…ç†ä»£ç  |

### 10.8 å®ç°ä¼˜å…ˆçº§ (æ›´æ–°)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|-----|-------|------|
| åˆ›å»º UnifiedPromptNode èŠ‚ç‚¹ | P0 | åˆå¹¶ä¸¤ä¸ªæç¤ºè¯èŠ‚ç‚¹ |
| å®šä¹‰ä¸‰ç§ JSON Schema | P0 | ModelPromptJson, PatternPromptJson, EcomPromptJson |
| å®ç° outputMode åˆ‡æ¢é€»è¾‘ | P0 | æ ¹æ®æ¨¡å¼é€‰æ‹©ç³»ç»Ÿæç¤ºè¯ |
| æ·»åŠ æ¡ä»¶æ˜¾ç¤ºé…ç½®é¡¹ | P1 | showWhen å®ç° |
| GeminiPatternNode æ¥æ”¶ JSON è¾“å…¥ | P1 | æ·»åŠ  patternPromptJson è¾“å…¥ |
| GeminiEcomNode æ¥æ”¶ JSON è¾“å…¥ | P1 | æ·»åŠ  ecomPromptJson è¾“å…¥ |
| æ ‡è®°æ—§èŠ‚ç‚¹ deprecated | P2 | ä¿æŒå‘åå…¼å®¹ |
| æµ‹è¯•å®Œæ•´æµæ°´çº¿ | P2 | éªŒè¯ JSON ä¼ é€’å’Œä½¿ç”¨ |

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.3*
*æœ€åæ›´æ–°: 2025-12-12*
*æ–°å¢: èŠ‚ç‚¹é—´åä½œè®¾è®¡ã€å®Œæ•´å·¥ä½œæµæ¨¡æ¿ã€ç»Ÿä¸€JSONæç¤ºè¯ç³»ç»Ÿã€åˆå¹¶æç¤ºè¯èŠ‚ç‚¹è®¾è®¡*
